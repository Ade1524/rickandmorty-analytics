version: 2

models:
  - name: int_char_single_episode
    description: This intermediate model unpivots the 'episode_urls' column from the staging characters data (which uses '|' as a  delimiter) into one row per character-episode combination.It extracts the Episode ID from the URL string to create a clean integer join key.
    columns:
      - name: character_id
        description: Primary ID of the character, derived from stg_characters
        tests: 
        - not_null
      - name: character_name
        description: Name of the character.
        tests: 
        - not_null
      - name: character_url
        description: Link to the character's own URL endpoint.
      - name: episode_id
        description: The id of the episode.
        tests: 
        - not_null  
      - name: episode_name
        description: Name of the episode.
        tests: 
        - not_null
      - name: episode_url
        description: The full, unnested URL for a single episode where the character appeared.
        tests:
          - not_null
      - name: total_episodes_feature
        description: Total episodes in which this character appeared.