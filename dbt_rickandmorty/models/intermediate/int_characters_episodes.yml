version: 2

models:
  - name: int_character_episodes
    description: "This intermediate model unpivots the 'episode_urls' column from the staging characters data (which uses '|' as a  delimiter) into one row per character-episode combination.It extracts the Episode ID from the URL string to create a clean integer join key."
    columns:
      - name: character_id
        description: "Primary ID of the character, derived from stg_characters"
        tests: 
        - not_null
      - name: character_name
        description: "Name of the character."
        tests: 
        - not_null
      - name: episode_url_full
        description: The full, unnested URL for a single episode where the character appeared.
        tests:
          - not_null
          - unique
      - name: episode_id_join_key
        description: The integer ID extracted from the episode URL, used to join with the episode dimension table (stg_episodes).
        tests:
          - not_null
          - relationships:
              field: <episode_id>
              to: ref('stg_episodes')