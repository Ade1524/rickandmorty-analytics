version: 2

models:
  - name: fct_character_episode
    description: Fact table capturing character appearances in episodes.

    columns:
      - name: dim_character_key
        description: Surrogate Key (FK) linking to the dim_character table.
        tests:  
        - not_null
        - relationships:
              to: ref('dim_character')
              field: dim_character_key

      - name: dim_episode_key
        description: Surrogate key (episode_id + episode_name + episode_code + episode_url).
        tests:  
        - not_null
        - relationships:
              to: ref('dim_episode')
              field: dim_episode_key  

      - name: dim_character_created_date_key
        description: Converted data type 'date' to string and then to integer from column 'character_day_created'. 
        tests: 
        - not_null
        - relationships:
              to: ref('dim_character')
              field: dim_character_created_date_key

      - name: dim_episode_date_created_key
        description: Converted data type 'date' to string and then to integer from column 'episode_day_created'. 
        tests: 
        - not_null 
        - relationships:
              to: ref('dim_episode')
              field: dim_episode_date_created_key 

      - name: dim_air_date_key
        description: Converted data type 'date' to string and then to integer from column 'air_date'. 
        tests: 
        - not_null  
        - relationships:
              to: ref('dim_episode')
              field: dim_air_date_key

      - name: character_id
        description: The id of the character.
        tests:
          - not_null
          - relationships:
              to: ref('dim_character')
              field: character_id

      - name: character_day_created
        description: Day at which the character was created in the database.

      - name: status
        description: The status of the character ('Alive', 'Dead' or 'unknown').

      - name: total_episodes_feature
        description: A calculated metric representing the total number of episodes this character has featured in (or the count used to aggregate to this fact's grain).

      - name: episode_id
        description: The id of the episode.
        tests:
          - not_null
          - relationships:
              to: ref('dim_episode')
              field: episode_id

      - name: episode_code
        description: The unique production code of the episode (e.g., S01E01)

      - name: total_character_featuring
        description: Total character featuring at the episode 
      
      - name: air_date
        description: The air date of the episode.  

      - name: episode_day_created
        description: Day at which the episode was created in the database.  






   
    
    




